<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Students App â€” Sign In</title>
    <!-- Bootstrap CSS + Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <style>
      :root {
        --grad-1: linear-gradient(135deg, #eef2ff, #e0f2fe);
        --brand: linear-gradient(135deg, #7c3aed, #2563eb);
      }
      body {
        background: var(--grad-1);
        min-height: 100vh;
        display: flex;
        align-items: center;
      }
      .login-shell {
        width: 100%;
      }
      .login-card {
        border-radius: 16px;
        box-shadow: 0 10px 28px rgba(0,0,0,0.18);
        background: #fff;
        padding: 2rem;
        width: 100%;
        max-width: 460px;
        margin: 0 auto;
      }
      .brand-badge {
        width: 72px; height: 72px; border-radius: 50%;
        display: inline-flex; align-items: center; justify-content: center;
        background: var(--brand); color: #fff;
        box-shadow:
          inset 0 4px 8px rgba(255,255,255,0.25),
          inset 0 -6px 12px rgba(0,0,0,0.25),
          0 8px 18px rgba(37,99,235,.35),
          0 14px 28px rgba(76,29,149,.22);
        position: relative;
      }
      .brand-badge::before {
        content: "";
        position: absolute;
        top: 8%; left: 12%; right: 12%; height: 24%;
        background: radial-gradient(ellipse at top, rgba(255,255,255,0.6), rgba(255,255,255,0) 70%);
        border-radius: 50%;
        filter: blur(1px);
      }
      .brand-badge::after {
        content: "";
        position: absolute; bottom: -10px; left: 15%; right: 15%; height: 10px;
        background: radial-gradient(ellipse at center, rgba(0,0,0,0.25), rgba(0,0,0,0));
        border-radius: 50%; filter: blur(6px); z-index: -1;
      }
      .subtitle { color: #64748b; }
      .btn-oauth { border-radius: 12px; padding: 12px; font-weight: 600; width: 100%; display: flex; align-items: center; justify-content: center; gap: 10px; transition: .2s; }
      .btn-keycloak { background: linear-gradient(145deg, #4f46e5, #2563eb); color: #fff; }
      .btn-keycloak:hover { filter: brightness(.98); color: #fff; }
      .btn-google { background: #fff; border: 1px solid #e5e7eb; color: #374151; }
      .btn-google:hover { background: #f9fafb; }
      .btn-github { background: #111827; color: #fff; }
      .btn-github:hover { background: #0b1220; color: #fff; }
      .divider { display:flex; align-items:center; gap:12px; color:#94a3b8; font-size:.9rem; }
      .divider::before, .divider::after { content:""; flex:1; height:1px; background:#e5e7eb; }
      .foot-links { font-size:.9rem; color:#6b7280; }
      .foot-links a { color:#4f46e5; text-decoration: none; }
      .foot-links a:hover { text-decoration: underline; }
    </style>
</head>
<body>

<div class="login-shell">
  <div class="login-card text-center">
    <div class="mb-3">
      <div class="brand-badge mb-2"><i class="bi bi-mortarboard-fill" style="font-size: 2rem;"></i></div>
      <h2 class="fw-bold mb-1 text-dark">Students App</h2>
      <p class="subtitle mb-2">Secure sign-in via your organization</p>
    </div>

    <!-- Success / Error messages (model and query params) -->
    <div th:if="${errorMsg}" class="alert alert-danger py-2" th:text="${errorMsg}"></div>
    <div th:if="${logoutMsg}" class="alert alert-success py-2" th:text="${logoutMsg}"></div>
    <div th:if="${param.error}" class="alert alert-danger py-2" th:text="${param.error}"></div>
    <div th:if="${param.logout}" class="alert alert-success py-2">You have been logged out.</div>

    <!-- Primary SSO: Keycloak -->
    <button id="btnKeycloak" class="btn btn-oauth btn-keycloak" onclick="go('/oauth2/authorization/keycloak', this)">
      <i class="bi bi-shield-lock-fill"></i>
      <span>Login with Keycloak</span>
    </button>

    <div class="text-start small mt-3 foot-links">
      <div class="mb-1"><i class="bi bi-info-circle"></i> Having trouble signing in? Contact support at <a href="mailto:support@example.com">support@example.com</a></div>
      <div>By continuing you agree to our <a href="#">Terms</a> and <a href="#">Privacy Policy</a>.</div>
    </div>
  </div>
</div>

<script>
  function go(url, btn){
    if (btn){
      btn.disabled = true;
      const span = btn.querySelector('span');
      const icon = btn.querySelector('i, img');
      if (span) span.textContent = 'Redirecting...';
      if (icon && icon.tagName !== 'IMG') icon.className = 'spinner-border spinner-border-sm';
    }
    window.location.href = url;
  }
</script>

</body>
</html>
